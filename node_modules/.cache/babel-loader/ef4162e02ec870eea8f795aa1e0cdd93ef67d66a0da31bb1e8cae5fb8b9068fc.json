{"ast":null,"code":"import React,{useState,useEffect}from\"react\";import\"./OrderNow.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const providerTypes=[{key:\"doctor\",label:\"ÿ∑ÿ®Ÿäÿ®\",icon:\"/doctor-icon.png\",color:\"#3182ce\"},{key:\"nurse\",label:\"ŸÖŸÖÿ±ÿ∂\",icon:\"/nurse-icon.png\",color:\"#38b2ac\"},{key:\"physio\",label:\"ÿπŸÑÿßÿ¨ ÿ∑ÿ®ŸäÿπŸä\",icon:\"/pharmacist-icon.png\",color:\"#f6ad55\"},{key:\"lab\",label:\"ÿ™ÿ≠ÿßŸÑŸäŸÑ\",icon:\"/pharmacist-icon.png\",color:\"#f56565\"},{key:\"xray\",label:\"ÿ£ÿ¥ÿπÿ©\",icon:\"/pharmacist-icon.png\",color:\"#805ad5\"},{key:\"pharmacist\",label:\"ÿµŸäÿØŸÑŸä\",icon:\"/pharmacist-icon.png\",color:\"#ecc94b\"}];export default function OrderNow(_ref){let{user}=_ref;const[step,setStep]=useState(0);const[selectedType,setSelectedType]=useState(null);const[specialties,setSpecialties]=useState([]);const[selectedSpecialty,setSelectedSpecialty]=useState(\"\");const[services,setServices]=useState([]);// ÿØÿπŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿ£ŸÉÿ´ÿ± ŸÖŸÜ ÿÆÿØŸÖÿ©\nconst[selectedServices,setSelectedServices]=useState([]);const[location,setLocation]=useState({address:\"\",lat:\"\",lng:\"\"});const[basePrice,setBasePrice]=useState(0);const[suggestedPrice,setSuggestedPrice]=useState(\"\");const[sending,setSending]=useState(false);// ŸÖÿ™ÿ∫Ÿäÿ± ŸÑÿ™ÿ≠ÿØŸäÿØ ÿ¢ÿÆÿ± ÿπŸÜÿµÿ± ŸÖÿÆÿ™ÿßÿ± (ŸÑÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä ÿßŸÑÿπÿµÿ±Ÿä)\nconst[lastSelectedIndex,setLastSelectedIndex]=useState(null);// Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ŸáŸÜÿß ŸàŸÑŸäÿ≥ ÿ®ÿπÿØ ÿßŸÑÿ¥ÿ±Ÿàÿ∑\nconst[showSuccess,setShowSuccess]=useState(false);// ÿ¨ŸÑÿ® ÿßŸÑÿ™ÿÆÿµÿµÿßÿ™ ŸÖŸÜ db.json\nuseEffect(()=>{if(selectedType){fetch(`http://localhost:5000/services?providerType=${selectedType.key}`).then(res=>res.json()).then(data=>{// ÿßÿ≥ÿ™ÿÆÿ±ÿ¨ ÿßŸÑÿ™ÿÆÿµÿµÿßÿ™ ÿßŸÑŸÅÿ±ŸäÿØÿ©\nconst specialties=[...new Set(data.map(s=>s.specialty))];setSpecialties(specialties);});}},[selectedType]);// ÿ¨ŸÑÿ® ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿ≠ÿ≥ÿ® ŸÜŸàÿπ ŸÖŸÇÿØŸÖ ÿßŸÑÿÆÿØŸÖÿ©\nuseEffect(()=>{if(selectedType){let endpoint=\"\";if(selectedType.key===\"nurse\")endpoint=\"/nurseServices\";else if(selectedType.key===\"doctor\")endpoint=\"/doctorServices\";else if(selectedType.key===\"physio\")endpoint=\"/physioServices\";else if(selectedType.key===\"pharmacist\")endpoint=\"/pharmacistServices\";else if(selectedType.key===\"lab\")endpoint=\"/labServices\";else if(selectedType.key===\"xray\")endpoint=\"/xrayServices\";if(endpoint){fetch(`http://localhost:5000${endpoint}`).then(res=>res.json()).then(data=>setServices(data||[]));}else{setServices([]);}}},[selectedType]);// ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ©\nuseEffect(()=>{if(selectedType&&selectedServices.length>0){const total=selectedServices.reduce((sum,name)=>{const service=services.find(s=>s.name===name);return sum+(service?service.basePrice:0);},0);setBasePrice(total);}else{setBasePrice(0);}},[selectedServices,services,selectedType]);// ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã\n// ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÖÿπ ÿ¨ŸÑÿ® ÿßŸÑÿπŸÜŸàÿßŸÜ ŸÖŸÜ OpenStreetMap (Nominatim)\nfunction detectLocation(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(async pos=>{const lat=pos.coords.latitude;const lng=pos.coords.longitude;// ÿ¨ŸÑÿ® ÿßŸÑÿπŸÜŸàÿßŸÜ ŸÖŸÜ Nominatim\nlet address=\"\";try{const res=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=ar`);const data=await res.json();address=data.display_name||\"\";}catch{}setLocation({...location,lat,lng,address});},err=>{alert(\"ÿ™ÿπÿ∞ÿ± ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑŸÖŸàŸÇÿπ ÿ£Ÿà ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÑÿßÿ≠ŸÇÿßŸã.\");},{enableHighAccuracy:true});}else{alert(\"ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØÿπŸÖ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä.\");}}// ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® (ŸäÿØÿπŸÖ ÿπÿØÿ© ÿÆÿØŸÖÿßÿ™)\n// ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® (ŸäÿØÿπŸÖ ÿπÿØÿ© ÿÆÿØŸÖÿßÿ™) ŸÖÿπ ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿ¨ÿßÿ≠ Ÿàÿ™Ÿàÿ¨ŸäŸá ÿ™ŸÑŸÇÿßÿ¶Ÿä\n// ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® (Ÿäÿ±ÿ®ÿ∑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÖŸÇÿØŸÖ ÿÆÿØŸÖÿ© ŸÖÿ™ÿßÿ≠)\nfunction handleSubmit(e){e.preventDefault();setSending(true);// ÿ¨ŸÑÿ® ŸÖŸÇÿØŸÖŸä ÿßŸÑÿÆÿØŸÖÿ© ÿßŸÑŸÖÿ™ÿßÿ≠ŸäŸÜ ŸÑŸáÿ∞ÿß ÿßŸÑÿ™ÿÆÿµÿµ\nfetch(`http://localhost:5000/users?type=provider&providerType=${encodeURIComponent(selectedType.label)}`).then(res=>res.json()).then(providers=>{// ÿßÿÆÿ™ÿ± ÿ£ŸàŸÑ ŸÖŸÇÿØŸÖ ÿÆÿØŸÖÿ© ŸÖÿ™ÿßÿ≠ (ŸäŸÖŸÉŸÜŸÉ ÿ™ÿ∑ŸàŸäÿ± ÿßŸÑŸÖŸÜÿ∑ŸÇ ŸÑÿßÿ≠ŸÇÿßŸã)\nconst provider=providers[0];const orderBody={patientId:user.id,providerType:selectedType.key,specialty:selectedSpecialty,serviceNames:selectedServices,location,basePrice,suggestedPrice,status:\"new\",createdAt:new Date().toISOString(),providerId:provider?provider.id:null,providerName:provider?provider.fullName:null,providerPhone:provider?provider.phone:null,patientName:user.fullName,address:location.address};return fetch(\"http://localhost:5000/orders\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(orderBody)});}).then(()=>{setSending(false);setShowSuccess(true);setTimeout(()=>{setShowSuccess(false);if(window&&window.location){window.location.href=\"/track-order\";}},1500);});}// Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ™ÿÆÿµÿµ ÿ£Ÿà ÿßŸÑÿÆÿØŸÖÿ©\nif(step===0){return/*#__PURE__*/_jsxs(\"div\",{className:\"order-cards-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0627\\u062E\\u062A\\u0631 \\u0646\\u0648\\u0639 \\u0645\\u0642\\u062F\\u0645 \\u0627\\u0644\\u062E\\u062F\\u0645\\u0629\"}),/*#__PURE__*/_jsx(\"div\",{className:\"cards-list\",children:providerTypes.map(type=>/*#__PURE__*/_jsxs(\"div\",{className:\"order-card\",style:{background:type.color},onClick:()=>{setSelectedType(type);setStep(1);},children:[/*#__PURE__*/_jsx(\"img\",{src:type.icon,alt:type.label,className:\"order-card-icon\"}),/*#__PURE__*/_jsx(\"div\",{children:type.label})]},type.key))})]});}// Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿÆÿØŸÖÿßÿ™ (ÿØÿπŸÖ multi-select + ÿ≤ÿ± \"ÿßŸÑÿ™ÿßŸÑŸä\" ÿ£ÿ≥ŸÅŸÑ ÿ¢ÿÆÿ± ÿÆÿØŸÖÿ© ŸÖÿÆÿ™ÿßÿ±ÿ© ÿ®ÿ¥ŸÉŸÑ ÿπÿµÿ±Ÿä)\nif(step===1&&selectedType){return/*#__PURE__*/_jsxs(\"div\",{className:\"order-step\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u0627\\u062E\\u062A\\u0631 \\u0627\\u0644\\u062E\\u062F\\u0645\\u0627\\u062A \\u0627\\u0644\\u0645\\u0637\\u0644\\u0648\\u0628\\u0629\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"services-list-grid-modern\",children:[services.length===0&&/*#__PURE__*/_jsx(\"div\",{className:\"no-services\",children:\"\\u0644\\u0627 \\u062A\\u0648\\u062C\\u062F \\u062E\\u062F\\u0645\\u0627\\u062A \\u0645\\u062A\\u0627\\u062D\\u0629 \\u0644\\u0647\\u0630\\u0627 \\u0627\\u0644\\u062A\\u062E\\u0635\\u0635 \\u062D\\u0627\\u0644\\u064A\\u0627\\u064B.\"}),services.map((s,idx)=>{const isSelected=selectedServices.includes(s.name);return/*#__PURE__*/_jsxs(\"div\",{className:`service-card-modern${isSelected?\" selected\":\"\"}`,onClick:()=>{setSelectedServices(prev=>{let next;if(isSelected){next=prev.filter(name=>name!==s.name);}else{next=[...prev,s.name];setLastSelectedIndex(idx);}// ÿ•ÿ∞ÿß ÿ£ŸÑÿ∫Ÿâ ÿ¢ÿÆÿ± ÿÆÿØŸÖÿ© ŸÖÿÆÿ™ÿßÿ±ÿ©ÿå ÿ≠ÿØÿ´ ÿßŸÑŸÖÿ§ÿ¥ÿ±\nif(isSelected&&lastSelectedIndex===idx){setLastSelectedIndex(null);}return next;});},children:[/*#__PURE__*/_jsx(\"div\",{className:\"service-icon-modern\",children:/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"\\u062E\\u062F\\u0645\\u0629\",children:\"\\uD83E\\uDE7A\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"service-info-modern\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"service-name-modern\",children:s.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"service-price-modern\",children:[s.basePrice,\" \\u062C.\\u0645\"]})]}),selectedServices.length>0&&lastSelectedIndex===idx&&/*#__PURE__*/_jsx(\"button\",{className:\"next-btn-modern floating-next-btn\",onClick:e=>{e.stopPropagation();setStep(3);},children:\"\\u0627\\u0644\\u062A\\u0627\\u0644\\u064A\"})]},s.id);})]})]});}// Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖŸàŸÇÿπ ŸàÿßŸÑÿ≥ÿπÿ±\nif(step===3&&selectedType){return/*#__PURE__*/_jsxs(_Fragment,{children:[showSuccess&&/*#__PURE__*/_jsxs(\"div\",{className:\"success-message-green modern-success\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"success-icon\",children:\"\\u2714\"}),\"\\u062A\\u0645 \\u0625\\u0631\\u0633\\u0627\\u0644 \\u0627\\u0644\\u0637\\u0644\\u0628 \\u0628\\u0646\\u062C\\u0627\\u062D! \\u0633\\u064A\\u062A\\u0645 \\u062A\\u062D\\u0648\\u064A\\u0644\\u0643 \\u0644\\u0635\\u0641\\u062D\\u0629 \\u062A\\u062A\\u0628\\u0639 \\u0627\\u0644\\u0637\\u0644\\u0628...\"]}),/*#__PURE__*/_jsxs(\"form\",{className:\"order-step\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u062D\\u062F\\u062F \\u0645\\u0648\\u0642\\u0639\\u0643\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"location-row-modern\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"modern-input\",placeholder:\"\\u0627\\u0644\\u0639\\u0646\\u0648\\u0627\\u0646 \\u0628\\u0627\\u0644\\u062A\\u0641\\u0635\\u064A\\u0644\",value:location.address,onChange:e=>setLocation({...location,address:e.target.value})}),/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"detect-btn-modern\",onClick:detectLocation,children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"\\u0645\\u0648\\u0642\\u0639\",children:\"\\uD83D\\uDCCD\"}),\" \\u062A\\u062D\\u062F\\u064A\\u062F \\u0627\\u0644\\u0645\\u0648\\u0642\\u0639 \\u062A\\u0644\\u0642\\u0627\\u0626\\u064A\\u0627\\u064B\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-box modern-price-box\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u0625\\u062C\\u0645\\u0627\\u0644\\u064A \\u0633\\u0639\\u0631 \\u0627\\u0644\\u062E\\u062F\\u0645\\u0627\\u062A:\"}),\" \",/*#__PURE__*/_jsxs(\"span\",{className:\"main-price\",children:[basePrice,\" \\u062C.\\u0645\"]})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"modern-input\",placeholder:\"\\u0627\\u0642\\u062A\\u0631\\u0627\\u062D \\u0633\\u0639\\u0631 (\\u0627\\u062E\\u062A\\u064A\\u0627\\u0631\\u064A)\",value:suggestedPrice,onChange:e=>setSuggestedPrice(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:sending,className:\"modern-send-btn\",children:sending?/*#__PURE__*/_jsx(\"span\",{className:\"loader\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{role:\"img\",\"aria-label\":\"\\u0625\\u0631\\u0633\\u0627\\u0644\",children:\"\\uD83D\\uDE80\"}),\" \\u0625\\u0631\\u0633\\u0627\\u0644 \\u0627\\u0644\\u0637\\u0644\\u0628\"]})})]})]});}return null;}","map":{"version":3,"names":["React","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","providerTypes","key","label","icon","color","OrderNow","_ref","user","step","setStep","selectedType","setSelectedType","specialties","setSpecialties","selectedSpecialty","setSelectedSpecialty","services","setServices","selectedServices","setSelectedServices","location","setLocation","address","lat","lng","basePrice","setBasePrice","suggestedPrice","setSuggestedPrice","sending","setSending","lastSelectedIndex","setLastSelectedIndex","showSuccess","setShowSuccess","fetch","then","res","json","data","Set","map","s","specialty","endpoint","length","total","reduce","sum","name","service","find","detectLocation","navigator","geolocation","getCurrentPosition","pos","coords","latitude","longitude","display_name","err","alert","enableHighAccuracy","handleSubmit","e","preventDefault","encodeURIComponent","providers","provider","orderBody","patientId","id","providerType","serviceNames","status","createdAt","Date","toISOString","providerId","providerName","fullName","providerPhone","phone","patientName","method","headers","body","JSON","stringify","setTimeout","window","href","className","children","type","style","background","onClick","src","alt","idx","isSelected","includes","prev","next","filter","role","stopPropagation","onSubmit","placeholder","value","onChange","target","disabled"],"sources":["C:/Users/Pc/Desktop/DnsJumper/backend/nurse-tracking-Patient/src/components/OrderNow.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport \"./OrderNow.css\";\r\n\r\nconst providerTypes = [\r\n  { key: \"doctor\", label: \"ÿ∑ÿ®Ÿäÿ®\", icon: \"/doctor-icon.png\", color: \"#3182ce\" },\r\n  { key: \"nurse\", label: \"ŸÖŸÖÿ±ÿ∂\", icon: \"/nurse-icon.png\", color: \"#38b2ac\" },\r\n  { key: \"physio\", label: \"ÿπŸÑÿßÿ¨ ÿ∑ÿ®ŸäÿπŸä\", icon: \"/pharmacist-icon.png\", color: \"#f6ad55\" },\r\n  { key: \"lab\", label: \"ÿ™ÿ≠ÿßŸÑŸäŸÑ\", icon: \"/pharmacist-icon.png\", color: \"#f56565\" },\r\n  { key: \"xray\", label: \"ÿ£ÿ¥ÿπÿ©\", icon: \"/pharmacist-icon.png\", color: \"#805ad5\" },\r\n  { key: \"pharmacist\", label: \"ÿµŸäÿØŸÑŸä\", icon: \"/pharmacist-icon.png\", color: \"#ecc94b\" },\r\n];\r\n\r\nexport default function OrderNow({ user }) {\r\n  const [step, setStep] = useState(0);\r\n  const [selectedType, setSelectedType] = useState(null);\r\n  const [specialties, setSpecialties] = useState([]);\r\n  const [selectedSpecialty, setSelectedSpecialty] = useState(\"\");\r\n  const [services, setServices] = useState([]);\r\n  // ÿØÿπŸÖ ÿßÿÆÿ™Ÿäÿßÿ± ÿ£ŸÉÿ´ÿ± ŸÖŸÜ ÿÆÿØŸÖÿ©\r\n  const [selectedServices, setSelectedServices] = useState([]);\r\n  const [location, setLocation] = useState({ address: \"\", lat: \"\", lng: \"\" });\r\n  const [basePrice, setBasePrice] = useState(0);\r\n  const [suggestedPrice, setSuggestedPrice] = useState(\"\");\r\n  const [sending, setSending] = useState(false);\r\n  // ŸÖÿ™ÿ∫Ÿäÿ± ŸÑÿ™ÿ≠ÿØŸäÿØ ÿ¢ÿÆÿ± ÿπŸÜÿµÿ± ŸÖÿÆÿ™ÿßÿ± (ŸÑÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä ÿßŸÑÿπÿµÿ±Ÿä)\r\n  const [lastSelectedIndex, setLastSelectedIndex] = useState(null);\r\n  // Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ŸáŸÜÿß ŸàŸÑŸäÿ≥ ÿ®ÿπÿØ ÿßŸÑÿ¥ÿ±Ÿàÿ∑\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n\r\n  // ÿ¨ŸÑÿ® ÿßŸÑÿ™ÿÆÿµÿµÿßÿ™ ŸÖŸÜ db.json\r\n  useEffect(() => {\r\n    if (selectedType) {\r\n      fetch(`http://localhost:5000/services?providerType=${selectedType.key}`)\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          // ÿßÿ≥ÿ™ÿÆÿ±ÿ¨ ÿßŸÑÿ™ÿÆÿµÿµÿßÿ™ ÿßŸÑŸÅÿ±ŸäÿØÿ©\r\n          const specialties = [...new Set(data.map(s => s.specialty))];\r\n          setSpecialties(specialties);\r\n        });\r\n    }\r\n  }, [selectedType]);\r\n\r\n  // ÿ¨ŸÑÿ® ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿ≠ÿ≥ÿ® ŸÜŸàÿπ ŸÖŸÇÿØŸÖ ÿßŸÑÿÆÿØŸÖÿ©\r\n  useEffect(() => {\r\n    if (selectedType) {\r\n      let endpoint = \"\";\r\n      if (selectedType.key === \"nurse\") endpoint = \"/nurseServices\";\r\n      else if (selectedType.key === \"doctor\") endpoint = \"/doctorServices\";\r\n      else if (selectedType.key === \"physio\") endpoint = \"/physioServices\";\r\n      else if (selectedType.key === \"pharmacist\") endpoint = \"/pharmacistServices\";\r\n      else if (selectedType.key === \"lab\") endpoint = \"/labServices\";\r\n      else if (selectedType.key === \"xray\") endpoint = \"/xrayServices\";\r\n      if (endpoint) {\r\n        fetch(`http://localhost:5000${endpoint}`)\r\n          .then(res => res.json())\r\n          .then(data => setServices(data || []));\r\n      } else {\r\n        setServices([]);\r\n      }\r\n    }\r\n  }, [selectedType]);\r\n\r\n  // ÿ≠ÿ≥ÿßÿ® ÿßŸÑÿ≥ÿπÿ± ÿßŸÑŸÉŸÑŸä ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑŸÖÿÆÿ™ÿßÿ±ÿ©\r\n  useEffect(() => {\r\n    if (selectedType && selectedServices.length > 0) {\r\n      const total = selectedServices.reduce((sum, name) => {\r\n        const service = services.find(s => s.name === name);\r\n        return sum + (service ? service.basePrice : 0);\r\n      }, 0);\r\n      setBasePrice(total);\r\n    } else {\r\n      setBasePrice(0);\r\n    }\r\n  }, [selectedServices, services, selectedType]);\r\n\r\n  // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã\r\n  // ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã ŸÖÿπ ÿ¨ŸÑÿ® ÿßŸÑÿπŸÜŸàÿßŸÜ ŸÖŸÜ OpenStreetMap (Nominatim)\r\n  function detectLocation() {\r\n    if (navigator.geolocation) {\r\n      navigator.geolocation.getCurrentPosition(async pos => {\r\n        const lat = pos.coords.latitude;\r\n        const lng = pos.coords.longitude;\r\n        // ÿ¨ŸÑÿ® ÿßŸÑÿπŸÜŸàÿßŸÜ ŸÖŸÜ Nominatim\r\n        let address = \"\";\r\n        try {\r\n          const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&accept-language=ar`);\r\n          const data = await res.json();\r\n          address = data.display_name || \"\";\r\n        } catch {}\r\n        setLocation({\r\n          ...location,\r\n          lat,\r\n          lng,\r\n          address\r\n        });\r\n      }, err => {\r\n        alert(\"ÿ™ÿπÿ∞ÿ± ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÑŸàÿµŸàŸÑ ŸÑŸÑŸÖŸàŸÇÿπ ÿ£Ÿà ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÑÿßÿ≠ŸÇÿßŸã.\");\r\n      }, { enableHighAccuracy: true });\r\n    } else {\r\n      alert(\"ÿßŸÑŸÖÿ™ÿµŸÅÿ≠ ŸÑÿß ŸäÿØÿπŸÖ ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿ∫ÿ±ÿßŸÅŸä.\");\r\n    }\r\n  }\r\n\r\n  // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® (ŸäÿØÿπŸÖ ÿπÿØÿ© ÿÆÿØŸÖÿßÿ™)\r\n  // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® (ŸäÿØÿπŸÖ ÿπÿØÿ© ÿÆÿØŸÖÿßÿ™) ŸÖÿπ ÿ±ÿ≥ÿßŸÑÿ© ŸÜÿ¨ÿßÿ≠ Ÿàÿ™Ÿàÿ¨ŸäŸá ÿ™ŸÑŸÇÿßÿ¶Ÿä\r\n  // ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® (Ÿäÿ±ÿ®ÿ∑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÖŸÇÿØŸÖ ÿÆÿØŸÖÿ© ŸÖÿ™ÿßÿ≠)\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    setSending(true);\r\n    // ÿ¨ŸÑÿ® ŸÖŸÇÿØŸÖŸä ÿßŸÑÿÆÿØŸÖÿ© ÿßŸÑŸÖÿ™ÿßÿ≠ŸäŸÜ ŸÑŸáÿ∞ÿß ÿßŸÑÿ™ÿÆÿµÿµ\r\n    fetch(`http://localhost:5000/users?type=provider&providerType=${encodeURIComponent(selectedType.label)}`)\r\n      .then(res => res.json())\r\n      .then(providers => {\r\n        // ÿßÿÆÿ™ÿ± ÿ£ŸàŸÑ ŸÖŸÇÿØŸÖ ÿÆÿØŸÖÿ© ŸÖÿ™ÿßÿ≠ (ŸäŸÖŸÉŸÜŸÉ ÿ™ÿ∑ŸàŸäÿ± ÿßŸÑŸÖŸÜÿ∑ŸÇ ŸÑÿßÿ≠ŸÇÿßŸã)\r\n        const provider = providers[0];\r\n        const orderBody = {\r\n          patientId: user.id,\r\n          providerType: selectedType.key,\r\n          specialty: selectedSpecialty,\r\n          serviceNames: selectedServices,\r\n          location,\r\n          basePrice,\r\n          suggestedPrice,\r\n          status: \"new\",\r\n          createdAt: new Date().toISOString(),\r\n          providerId: provider ? provider.id : null,\r\n          providerName: provider ? provider.fullName : null,\r\n          providerPhone: provider ? provider.phone : null,\r\n          patientName: user.fullName,\r\n          address: location.address\r\n        };\r\n        return fetch(\"http://localhost:5000/orders\", {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(orderBody),\r\n        });\r\n      })\r\n      .then(() => {\r\n        setSending(false);\r\n        setShowSuccess(true);\r\n        setTimeout(() => {\r\n          setShowSuccess(false);\r\n          if (window && window.location) {\r\n            window.location.href = \"/track-order\";\r\n          }\r\n        }, 1500);\r\n      });\r\n  }\r\n\r\n  // Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿ™ÿÆÿµÿµ ÿ£Ÿà ÿßŸÑÿÆÿØŸÖÿ©\r\n  if (step === 0) {\r\n    return (\r\n      <div className=\"order-cards-container\">\r\n        <h2>ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ŸÖŸÇÿØŸÖ ÿßŸÑÿÆÿØŸÖÿ©</h2>\r\n        <div className=\"cards-list\">\r\n          {providerTypes.map((type) => (\r\n            <div\r\n              key={type.key}\r\n              className=\"order-card\"\r\n              style={{ background: type.color }}\r\n              onClick={() => {\r\n                setSelectedType(type);\r\n                setStep(1);\r\n              }}\r\n            >\r\n              <img src={type.icon} alt={type.label} className=\"order-card-icon\" />\r\n              <div>{type.label}</div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Ÿàÿßÿ¨Ÿáÿ© ÿßÿÆÿ™Ÿäÿßÿ± ÿßŸÑÿÆÿØŸÖÿßÿ™ (ÿØÿπŸÖ multi-select + ÿ≤ÿ± \"ÿßŸÑÿ™ÿßŸÑŸä\" ÿ£ÿ≥ŸÅŸÑ ÿ¢ÿÆÿ± ÿÆÿØŸÖÿ© ŸÖÿÆÿ™ÿßÿ±ÿ© ÿ®ÿ¥ŸÉŸÑ ÿπÿµÿ±Ÿä)\r\n  if (step === 1 && selectedType) {\r\n    return (\r\n      <div className=\"order-step\">\r\n        <h2>ÿßÿÆÿ™ÿ± ÿßŸÑÿÆÿØŸÖÿßÿ™ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ©</h2>\r\n        <div className=\"services-list-grid-modern\">\r\n          {services.length === 0 && <div className=\"no-services\">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿÆÿØŸÖÿßÿ™ ŸÖÿ™ÿßÿ≠ÿ© ŸÑŸáÿ∞ÿß ÿßŸÑÿ™ÿÆÿµÿµ ÿ≠ÿßŸÑŸäÿßŸã.</div>}\r\n          {services.map((s, idx) => {\r\n            const isSelected = selectedServices.includes(s.name);\r\n            return (\r\n              <div\r\n                key={s.id}\r\n                className={`service-card-modern${isSelected ? \" selected\" : \"\"}`}\r\n                onClick={() => {\r\n                  setSelectedServices(prev => {\r\n                    let next;\r\n                    if (isSelected) {\r\n                      next = prev.filter(name => name !== s.name);\r\n                    } else {\r\n                      next = [...prev, s.name];\r\n                      setLastSelectedIndex(idx);\r\n                    }\r\n                    // ÿ•ÿ∞ÿß ÿ£ŸÑÿ∫Ÿâ ÿ¢ÿÆÿ± ÿÆÿØŸÖÿ© ŸÖÿÆÿ™ÿßÿ±ÿ©ÿå ÿ≠ÿØÿ´ ÿßŸÑŸÖÿ§ÿ¥ÿ±\r\n                    if (isSelected && lastSelectedIndex === idx) {\r\n                      setLastSelectedIndex(null);\r\n                    }\r\n                    return next;\r\n                  });\r\n                }}\r\n              >\r\n                <div className=\"service-icon-modern\">\r\n                  <span role=\"img\" aria-label=\"ÿÆÿØŸÖÿ©\">ü©∫</span>\r\n                </div>\r\n                <div className=\"service-info-modern\">\r\n                  <div className=\"service-name-modern\">{s.name}</div>\r\n                  <div className=\"service-price-modern\">{s.basePrice} ÿ¨.ŸÖ</div>\r\n                </div>\r\n                {/* ÿ≤ÿ± ÿßŸÑÿ™ÿßŸÑŸä Ÿäÿ∏Ÿáÿ± ÿ£ÿ≥ŸÅŸÑ ÿ¢ÿÆÿ± ÿÆÿØŸÖÿ© ŸÖÿÆÿ™ÿßÿ±ÿ© */}\r\n                {selectedServices.length > 0 && lastSelectedIndex === idx && (\r\n                  <button\r\n                    className=\"next-btn-modern floating-next-btn\"\r\n                    onClick={e => {\r\n                      e.stopPropagation();\r\n                      setStep(3);\r\n                    }}\r\n                  >\r\n                    ÿßŸÑÿ™ÿßŸÑŸä\r\n                  </button>\r\n                )}\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n\r\n  // Ÿàÿßÿ¨Ÿáÿ© ÿßŸÑŸÖŸàŸÇÿπ ŸàÿßŸÑÿ≥ÿπÿ±\r\n  if (step === 3 && selectedType) {\r\n    return (\r\n      <>\r\n        {showSuccess && (\r\n          <div className=\"success-message-green modern-success\">\r\n            <span className=\"success-icon\">‚úî</span>\r\n            ÿ™ŸÖ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ≥Ÿäÿ™ŸÖ ÿ™ÿ≠ŸàŸäŸÑŸÉ ŸÑÿµŸÅÿ≠ÿ© ÿ™ÿ™ÿ®ÿπ ÿßŸÑÿ∑ŸÑÿ®...\r\n          </div>\r\n        )}\r\n        <form className=\"order-step\" onSubmit={handleSubmit}>\r\n          <h2>ÿ≠ÿØÿØ ŸÖŸàŸÇÿπŸÉ</h2>\r\n          <div className=\"location-row-modern\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"modern-input\"\r\n              placeholder=\"ÿßŸÑÿπŸÜŸàÿßŸÜ ÿ®ÿßŸÑÿ™ŸÅÿµŸäŸÑ\"\r\n              value={location.address}\r\n              onChange={e => setLocation({ ...location, address: e.target.value })}\r\n            />\r\n            <button type=\"button\" className=\"detect-btn-modern\" onClick={detectLocation}>\r\n              <span role=\"img\" aria-label=\"ŸÖŸàŸÇÿπ\">üìç</span> ÿ™ÿ≠ÿØŸäÿØ ÿßŸÑŸÖŸàŸÇÿπ ÿ™ŸÑŸÇÿßÿ¶ŸäÿßŸã\r\n            </button>\r\n          </div>\r\n          <div className=\"price-box modern-price-box\">\r\n            <b>ÿ•ÿ¨ŸÖÿßŸÑŸä ÿ≥ÿπÿ± ÿßŸÑÿÆÿØŸÖÿßÿ™:</b> <span className=\"main-price\">{basePrice} ÿ¨.ŸÖ</span>\r\n          </div>\r\n          <input\r\n            type=\"number\"\r\n            className=\"modern-input\"\r\n            placeholder=\"ÿßŸÇÿ™ÿ±ÿßÿ≠ ÿ≥ÿπÿ± (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä)\"\r\n            value={suggestedPrice}\r\n            onChange={e => setSuggestedPrice(e.target.value)}\r\n          />\r\n          <button type=\"submit\" disabled={sending} className=\"modern-send-btn\">\r\n            {sending ? <span className=\"loader\"></span> : <><span role=\"img\" aria-label=\"ÿ•ÿ±ÿ≥ÿßŸÑ\">üöÄ</span> ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ∑ŸÑÿ®</>}\r\n          </button>\r\n        </form>\r\n      </>\r\n    );\r\n  }\r\n\r\n  return null;\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}